<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Loading...</title>

  <link rel="icon" type="image/png" id="dynFavicon" href=""/>
  
  <!-- FONT AWESOME -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
  
  <!-- ALL FONTS -->
  <link href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&family=Anton&family=Bangers&family=Bebas+Neue&family=Cinzel:wght@400;700&family=Creepster&family=Dancing+Script:wght@400;700&family=Lobster&family=Monoton&family=Orbitron:wght@400;700;900&family=Oswald:wght@400;700&family=Poppins:wght@300;400;600&family=Rajdhani:wght@400;600;700&family=Rock+Salt&family=Satisfy&display=swap" rel="stylesheet"/>

  <style>
    :root {
        --user-font: 'Rajdhani', sans-serif;
        --btn-base: #151515; 
        --audio-color: #00f2ff;
        /* FIXED AUDIO FONT (CREEPSTER) */
        --fixed-player-font: 'Creepster', system-ui; 
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; -webkit-user-select: none; user-select: none; }
    input, textarea { -webkit-user-select: text; user-select: text; }
    
    html, body {
        height: 100%; overflow: hidden; background: #000; 
        background-size: cover; background-position: center; background-attachment: fixed;
        color: #fff; font-family: var(--user-font) !important;
        touch-action: pan-y; overscroll-behavior-y: none;
    }

    /* FORCE FONT */
    .username, .loader-text, .section-label { font-family: var(--user-font) !important; }
    .universal-btn, .btn-text, .inline-pass-input { font-family: var(--user-font) !important; }
    
    footer, .footer-title, .footer-sub { font-family: 'Orbitron', sans-serif !important; }

    /* PRELOADER */
    #preloader { position: fixed; inset: 0; background: #000; z-index: 99999; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.5s ease; }
    .loader-ring { 
        width: 60px; height: 60px; 
        border: 4px solid rgba(255, 255, 255, 0.1); 
        border-top-color: #00f2ff; border-bottom-color: #ff00e5;
        border-radius: 50%; animation: spin 0.8s linear infinite; margin-bottom: 20px; 
    }
    .loader-text { letter-spacing: 3px; font-size: 0.9rem; animation: pulse 1.5s infinite; color: #fff; font-weight: bold; }

    .main-container { width: 100%; height: 100%; overflow-y: auto; max-width: 500px; margin: 0 auto; padding: 30px 20px 20px 20px; text-align: center; display: none; overscroll-behavior-y: none; opacity: 0; transition: opacity 0.5s ease; }
    .main-container.show { opacity: 1; }

    .profile-section { display: flex; flex-direction: column; align-items: center; margin-bottom: 25px; }
    .avatar-wrapper { position: relative; width: 100px; height: 100px; margin-bottom: 15px; display: flex; justify-content: center; align-items: center; border-radius: 50%; }
    .avatar-wrapper::before { content: ''; position: absolute; inset: 0; border-radius: 50%; z-index: 0; background: transparent; box-shadow: 0 0 15px #00f2ff; animation: breatheGlow 2.5s ease-in-out infinite alternate, hueRotate 10s linear infinite; }
    .ring { position: absolute; inset: -1px; border-radius: 50%; z-index: 1; background: conic-gradient(from 0deg, transparent 0%, transparent 40%, #00f2ff 100%); animation: spin 1.5s linear infinite, hueRotate 10s linear infinite; }
    .avatar-img { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; z-index: 2; position: relative; border: 2px solid rgba(0,0,0,0.3); }
    
    @keyframes spin { 100% { transform: rotate(360deg); } }
    @keyframes breatheGlow { 0% { opacity: 0.5; box-shadow: 0 0 10px #00f2ff; } 100% { opacity: 1.0; box-shadow: 0 0 35px #00f2ff; } }
    @keyframes hueRotate { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }

    .username { font-size: 1.8rem; font-weight: 900; background: linear-gradient(90deg, #fff, #00f2ff, #ff00e5, #fff); background-size: 300% 100%; -webkit-background-clip: text; background-clip: text; color: transparent; animation: textShine 4s linear infinite; margin-bottom: 5px; letter-spacing: 1px; }
    @keyframes textShine { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
    .bio { font-size: 0.9rem; color: #aaa; max-width: 90%; line-height: 1.4; }

    /* --- AUDIO PLAYER --- */
    .audio-player { 
        background: rgba(255,255,255,0.05); 
        border: 1px solid rgba(255,255,255,0.1); 
        border-radius: 50px; 
        padding: 6px 15px 6px 6px; 
        margin-bottom: 25px; 
        display: flex; 
        align-items: center; 
        gap: 10px; 
        backdrop-filter: blur(10px); 
        position: relative; 
        overflow: hidden; 
        font-family: var(--fixed-player-font) !important; 
    }
    .audio-player * { font-family: var(--fixed-player-font) !important; letter-spacing: 1px; }

    .play-btn { width: 38px; height: 38px; border-radius: 50%; border: none; background: var(--audio-color); color: #000; cursor: pointer; display: flex; justify-content: center; align-items: center; z-index: 2; transition:0.3s; }
    .play-btn svg { width: 14px; height: 14px; fill: #000; display: block; }

    .track-info { flex: 1; text-align: left; overflow: hidden; z-index: 2; position: relative; mask-image: linear-gradient(90deg, transparent, #000 5%, #000 95%, transparent); }
    .track-name { font-size: 1.1rem; font-weight: 400; color: #fff; display: inline-block; padding-left: 100%; animation: scrollText 10s linear infinite; }
    @keyframes scrollText { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
    .track-status { font-size: 0.8rem; color: var(--audio-color); text-transform: uppercase; margin-top: -2px; }

    .equalizer { display: flex; gap: 4px; align-items: flex-end; height: 20px; margin-left: 5px; z-index: 2; opacity: 0.6; transition: 0.3s; }
    .equalizer.playing { opacity: 1; }
    .bar { width: 4px; border-radius: 2px; height: 3px; background: linear-gradient(to top, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff); background-size: 100% 400%; }
    .equalizer.playing .bar:nth-child(1) { animation: bounce 0.4s infinite alternate, rainbowFlow 2s linear infinite; }
    .equalizer.playing .bar:nth-child(2) { animation: bounce 0.6s infinite alternate 0.1s, rainbowFlow 2.3s linear infinite; }
    .equalizer.playing .bar:nth-child(3) { animation: bounce 0.5s infinite alternate 0.2s, rainbowFlow 2.6s linear infinite; }
    @keyframes bounce { 0% { height: 4px; } 100% { height: 22px; } }
    @keyframes rainbowFlow { 0% { background-position: 0% 100%; filter: hue-rotate(0deg); } 100% { background-position: 0% 0%; filter: hue-rotate(360deg); } }

    /* --- CINEMATIC SLIDER --- */
    .slider-box { width: 100%; aspect-ratio: 16/9; border-radius: 12px; overflow: hidden; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.15); position: relative; pointer-events: none; }
    .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; }
    .slide img { width: 100%; height: 100%; object-fit: cover; }
    .slide.active { opacity: 1; z-index: 1; }
    .slide.incoming { z-index: 2; animation: enterBlur 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
    .slide.outgoing { z-index: 1; animation: exitFade 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
    @keyframes enterBlur { 0% { opacity: 0; transform: translateX(60%) scale(1.1); filter: blur(8px); } 100% { opacity: 1; transform: translateX(0) scale(1); filter: blur(0px); } }
    @keyframes exitFade { 0% { opacity: 1; transform: translateX(0); filter: blur(0px); } 100% { opacity: 0; transform: translateX(-30%); filter: blur(4px); } }

    .section-label { font-size: 0.75rem; color: #555; letter-spacing: 3px; margin: 25px 0 10px; text-transform: uppercase; border-bottom: 1px solid #222; padding-bottom: 5px; }
    .btn-container { display: flex; flex-direction: column; gap: 12px; width: 100%; margin-bottom: 10px; }
    .universal-btn { position: relative; height: 55px; width: 100%; border-radius: 8px; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; cursor: pointer; overflow: hidden; }
    .universal-btn:hover { transform: scale(1.02); }

    /* BUTTON STYLES */
    .style-default { background: linear-gradient(90deg, var(--btn-base), #000); border: 1px solid #00f2ff; }
    .style-glass { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-left: 3px solid var(--btn-base); }
    .style-neon { background: transparent; border: 1px solid var(--btn-base); box-shadow: 0 0 5px var(--btn-base), inset 0 0 10px rgba(0,0,0,0.5); }
    .style-neon .btn-text { text-shadow: 0 0 5px var(--btn-base); }
    .style-flat { background: var(--btn-base); border: none; border-radius: 4px; }
    .style-3d { background: var(--btn-base); border: 1px solid rgba(255,255,255,0.1); border-bottom: 4px solid #000; transform: translateY(0); border-radius: 6px; }
    .style-3d:active { transform: translateY(2px); border-bottom: 2px solid #000; }
    .style-round { background: var(--btn-base); border-radius: 50px; border: 1px solid rgba(255,255,255,0.2); }
    .style-cyber { background: var(--btn-base); clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px); border-left: 4px solid #fff; text-transform: uppercase; }
    .style-cyber:hover { background: #fff; } .style-cyber:hover .btn-text { color: #000; } .style-cyber:hover .btn-icon-font { color: #000; }
    .style-neumorph { background: #111; border-radius: 12px; box-shadow:  5px 5px 10px #080808, -5px -5px 10px #1a1a1a; border: 1px solid #1a1a1a; }
    .style-neumorph:active { box-shadow: inset 5px 5px 10px #080808, inset -5px -5px 10px #1a1a1a; }
    .style-retro { background: #000; border: 2px solid var(--btn-base); box-shadow: 4px 4px 0px var(--btn-base); border-radius: 0; }
    .style-retro:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px var(--btn-base); }
    .style-grad-border { background: #000; border: 2px solid transparent; background-image: linear-gradient(#000, #000), linear-gradient(45deg, #f00, #ff0, #0f0, #0ff, #00f, #f0f); background-origin: border-box; background-clip: padding-box, border-box; border-radius: 10px; }
    .style-stripe { background: repeating-linear-gradient(45deg, var(--btn-base), var(--btn-base) 10px, rgba(0,0,0,0.8) 10px, rgba(0,0,0,0.8) 20px); border: 1px solid rgba(255,255,255,0.3); }
    .style-stripe .btn-text { background: #000; padding: 2px 8px; border-radius: 4px; }
    .style-pulse { background: transparent; border: 1px solid var(--btn-base); border-radius: 50px; box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); animation: btnPulse 2s infinite; }
    @keyframes btnPulse { 0% { transform: scale(0.98); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); } 70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); } 100% { transform: scale(0.98); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); } }

    .btn-left { position: absolute; left: 10px; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; pointer-events: none; }
    .btn-logo-img { width: 100%; height: 100%; object-fit: cover; border-radius: 6px; }
    .btn-icon-font { font-size: 1.3rem; color: #fff; }
    .btn-text { font-size: 0.95rem; font-weight: 700; color: #fff; letter-spacing: 0.5px; z-index: 2; pointer-events: none; }
    .btn-right { position: absolute; right: 15px; font-size: 1rem; color: #ccc; transition: 0.3s; }
    .btn-right.locked { color: #ff3333; text-shadow: 0 0 5px rgba(255, 51, 51, 0.5); }
    .inline-pass-input { width: 100%; height: 100%; background: #000; border: none; color: var(--btn-base); text-align: center; font-size: 1.2rem; letter-spacing: 3px; outline: none; padding: 0 10px; animation: glow 1s infinite alternate; z-index: 10; }

    footer { margin-top: 50px; padding: 10px 20px 2px 20px; border-top: 1px solid #fff; background: linear-gradient(0deg, rgba(255,255,255,0.05) 0%, transparent 100%); text-align: center; }
    .footer-title { font-size: 1rem; color: #fff; letter-spacing: 2px; margin-bottom: 5px; font-weight: 800; pointer-events: none; }
    .footer-sub { font-size: 0.7rem; color: #fff; letter-spacing: 1px; pointer-events: none; }
  </style>

</head>
<body>
  <div id="preloader"><div class="loader-ring"></div><div class="loader-text">SYNCING DATA...</div></div>

  <div class="main-container" id="mainContainer">
    <div class="profile-section">
      <div class="avatar-wrapper">
        <div class="ring"></div>
        <img src="" class="avatar-img" id="userAvatar">
      </div>
      <div class="username" id="userName">...</div>
      <div class="bio" id="userBio"></div>
    </div>

    <!-- AUDIO PLAYER -->
    <div class="audio-player">
      <button class="play-btn" id="playBtn">
        <svg id="playSVG" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M8 5v14l11-7z"/></svg>
      </button>
      <div class="track-info">
        <div class="track-name-container"><div class="track-name" id="trackName">Loading Music...</div></div>
        <div class="track-status" id="trackStatus">Tap to Play</div>
      </div>
      <div class="equalizer" id="equalizer"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
    </div>
    <audio id="audio" preload="auto"></audio>

    <div class="slider-box" id="sliderBox"></div>

    <div class="section-label">Websites</div>
    <div class="btn-container" id="webList"></div>
    <div class="section-label">Social Media</div>
    <div class="btn-container" id="socList"></div>

    <footer>
      <div class="footer-title" id="footerText">SYSTEM SECURE</div>
      <div class="footer-sub">Â© 2026 COPYRIGHT RESERVED</div>
    </footer>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
    import { getDatabase, ref, onValue, push } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBjoMwaLWplKS3GcdsF_2KgKXh1mVK9eyE",
  authDomain: "my-bio-a25f3.firebaseapp.com",
  databaseURL: "https://my-bio-a25f3-default-rtdb.firebaseio.com",
  projectId: "my-bio-a25f3",
  storageBucket: "my-bio-a25f3.firebasestorage.app",
  messagingSenderId: "250076954421",
  appId: "1:250076954421:web:f6e53accbda1034b5d567c"
};

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const els = {
      preloader: document.getElementById('preloader'), mainContainer: document.getElementById('mainContainer'),
      avatar: document.getElementById('userAvatar'), userName: document.getElementById('userName'),
      userBio: document.getElementById('userBio'), footerText: document.getElementById('footerText'),
      trackName: document.getElementById('trackName'), trackStatus: document.getElementById('trackStatus'),
      equalizer: document.getElementById('equalizer'), audio: document.getElementById('audio'),
      playBtn: document.getElementById('playBtn'), sliderBox: document.getElementById('sliderBox'),
      webList: document.getElementById('webList'), socList: document.getElementById('socList'), fav: document.getElementById('dynFavicon')
    };

    // --- LOADING LOGIC ---
    let loaded = { settings: false, audio: false, web: false, soc: false, slide: false };
    function checkAllLoaded() { if(loaded.settings && loaded.web && loaded.soc && loaded.audio && loaded.slide) revealSite(); }

    let isSiteRevealed = false;
    function revealSite() {
        if(!isSiteRevealed) {
            isSiteRevealed = true;
            els.preloader.style.opacity = '0';
            els.mainContainer.style.display = 'block';
            setTimeout(() => {
                els.mainContainer.classList.add('show');
                els.preloader.style.display = 'none';
            }, 500);
        }
    }
    setTimeout(() => revealSite(), 4000);

    const visitKey = 'site_visited_unique';
    if(!localStorage.getItem(visitKey)) {
        push(ref(db, 'analytics/visits'), { time: Date.now(), source: document.referrer || 'Direct' });
        localStorage.setItem(visitKey, 'true');
    }

    // --- FETCH SETTINGS ---
    onValue(ref(db, 'settings'), (snap) => {
      const set = snap.val() || {};
      if(set.bgImage && set.bgImage.trim() !== "") document.body.style.backgroundImage = `linear-gradient(180deg, rgba(0,0,0,0.7) 0%, #000 100%), url('${set.bgImage}')`;
      else document.body.style.backgroundImage = `linear-gradient(180deg, rgba(0,0,0,0.7) 0%, #000 100%), url('https://images.unsplash.com/photo-1534239143101-1b1c627395c5?q=80&w=1000&auto=format&fit=crop')`;
      
      els.userName.innerText = set.username || "User"; 
      els.userBio.innerText = set.bio || "";
      els.avatar.src = set.avatar || "https://via.placeholder.com/150"; 
      els.footerText.innerText = set.footer || "SYSTEM SECURE";
      document.title = set.siteName || "Interface"; 
      els.fav.href = set.siteLogo || set.avatar;

      const r = document.documentElement;
      r.style.setProperty('--user-font', set.uiFont || "'Rajdhani', sans-serif"); 
      r.style.setProperty('--btn-base', set.uiBtnColor || "#151515");
      r.style.setProperty('--audio-color', set.uiAudioColor || "#00f2ff");
      window.btnStyleClass = `style-${set.uiBtnStyle || 'neon'}`;
      
      loaded.settings = true; checkAllLoaded();
    });

    onValue(ref(db, 'websites'), (s) => { renderButtons(s.val(), els.webList); loaded.web = true; checkAllLoaded(); });
    onValue(ref(db, 'socials'), (s) => { renderButtons(s.val(), els.socList); loaded.soc = true; checkAllLoaded(); });

    // --- AUDIO LOGIC (MEMORY + NO REPEAT) ---
    let allTracks = []; 
    let audioInitialized = false; 
    let wasPlayingBeforeHidden = false;

    document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
            if (!els.audio.paused) { wasPlayingBeforeHidden = true; els.audio.pause(); updatePlayerUI(false); } 
            else { wasPlayingBeforeHidden = false; }
        } else {
            if (wasPlayingBeforeHidden) { els.audio.play().then(() => updatePlayerUI(true)).catch(() => {}); }
        }
    });

    function unlockAudio() {
        if(allTracks.length > 0 && els.audio.paused) { els.audio.play().then(() => updatePlayerUI(true)).catch(() => {}); }
        if(!els.audio.paused) {
             document.removeEventListener('click', unlockAudio);
             document.removeEventListener('touchstart', unlockAudio);
        }
    }
    document.addEventListener('click', unlockAudio);
    document.addEventListener('touchstart', unlockAudio);

    function initAudio(data) {
        if(!data) { els.trackName.innerText = "No Audio Available"; els.trackStatus.innerText = "Offline"; }
        else {
            allTracks = Object.values(data);
            if(allTracks.length > 0) { pickRandomTrack(true); audioInitialized = true; }
        }
    }

    // FIXED: LOCAL STORAGE MEMORY TO PREVENT REPEATS ON RELOAD
    function pickRandomTrack(attemptAutoPlay = false) {
        if(allTracks.length === 0) return;
        
        let candidates = allTracks;
        // Check local storage for the last played track link
        const lastPlayedLink = localStorage.getItem('lastPlayedTrack');

        // If we have more than 1 track, remove the previously played one from candidates
        if (allTracks.length > 1 && lastPlayedLink) {
            candidates = allTracks.filter(t => t.link !== lastPlayedLink);
            // Safety fallback if something went wrong
            if (candidates.length === 0) candidates = allTracks;
        }

        // Pick random from valid candidates
        const randomTrack = candidates[Math.floor(Math.random() * candidates.length)];
        
        // Save this track as the last played
        localStorage.setItem('lastPlayedTrack', randomTrack.link);

        els.audio.src = randomTrack.link;
        els.trackName.innerText = randomTrack.name;
        
        if(attemptAutoPlay) {
            els.audio.play().then(() => updatePlayerUI(true)).catch(() => {
                els.trackStatus.innerText = "TAP ANYWHERE TO START";
                updatePlayerUI(false);
            });
        }
    }

    els.audio.addEventListener('ended', () => { pickRandomTrack(true); });
    onValue(ref(db, 'audio_list'), (snap) => { initAudio(snap.val()); loaded.audio = true; checkAllLoaded(); });

    els.playBtn.addEventListener('click', (e) => {
        e.stopPropagation(); 
        if(!els.audio.src) { pickRandomTrack(true); return; }
        if(els.audio.paused) { els.audio.play().then(() => updatePlayerUI(true)); } else { els.audio.pause(); updatePlayerUI(false); }
    });

    function updatePlayerUI(isPlaying) {
        if(isPlaying) { 
            els.playBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>'; 
            els.trackStatus.innerText = "Playing..."; 
            els.equalizer.classList.add('playing'); 
        } else { 
            els.playBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path d="M8 5v14l11-7z"/></svg>'; 
            if(els.trackStatus.innerText !== "TAP ANYWHERE TO START") els.trackStatus.innerText = "Paused";
            els.equalizer.classList.remove('playing'); 
        }
    }

    // --- SLIDER LOGIC ---
    let sliderInterval;
    let currentSlide = 0;
    
    function startSlider() {
        const slides = els.sliderBox.getElementsByClassName('slide');
        if (slides.length <= 1) {
            if(slides.length === 1) slides[0].classList.add('active'); 
            return;
        }
        slides[0].classList.add('active');
        if (sliderInterval) clearInterval(sliderInterval);
        sliderInterval = setInterval(() => {
            const nextSlide = (currentSlide + 1) % slides.length;
            for(let s of slides) {
                s.classList.remove('incoming', 'outgoing');
                if(s !== slides[currentSlide]) s.classList.remove('active');
            }
            slides[currentSlide].classList.add('outgoing'); 
            slides[nextSlide].classList.add('active', 'incoming'); 
            setTimeout(() => {
                slides[currentSlide].classList.remove('active', 'outgoing');
                slides[nextSlide].classList.remove('incoming');
                currentSlide = nextSlide;
            }, 1500); 
        }, 4000); 
    }

    onValue(ref(db, 'slider'), (snap) => {
      const data = snap.val(); els.sliderBox.innerHTML = "";
      if(data) { 
          Object.values(data).forEach(url => { els.sliderBox.innerHTML += `<div class="slide"><img src="${url}"></div>`; }); 
          setTimeout(startSlider, 100); 
      }
      loaded.slide = true; checkAllLoaded();
    });

    function renderButtons(dataObj, container) {
      container.innerHTML = "";
      if(!dataObj) return;
      const currentStyle = window.btnStyleClass || 'style-neon';
      Object.values(dataObj).forEach(item => {
        const isLocked = item.password && item.password.trim() !== "";
        let leftContent = "";
        if(item.icon && item.icon.includes('http')) leftContent = `<img src="${item.icon}" class="btn-logo-img">`;
        else if (item.icon && (item.icon.includes('fa-') || item.icon.includes('fab'))) leftContent = `<i class="${item.icon} btn-icon-font"></i>`;
        else { const domain = item.link && item.link.includes('http') ? new URL(item.link).hostname : ''; leftContent = `<img src="https://www.google.com/s2/favicons?domain=${domain}&sz=64" class="btn-logo-img">`; }
        const rightIcon = isLocked ? '<i class="fas fa-lock btn-right locked"></i>' : '<i class="fas fa-share-alt btn-right"></i>';
        const div = document.createElement('div');
        div.className = `universal-btn ${currentStyle}`;
        const originalHTML = `<div class="btn-left">${leftContent}</div><div class="btn-text">${item.title || 'Link'}</div>${rightIcon}`;
        div.innerHTML = originalHTML;
        div.onclick = (e) => {
          if(e.target.tagName === 'INPUT') return;
          const clickKey = `clicked_${item.link}`;
          if (!sessionStorage.getItem(clickKey)) { push(ref(db, 'analytics/clicks'), { time: Date.now(), btnTitle: item.title, link: item.link, icon: item.icon }); sessionStorage.setItem(clickKey, 'true'); }
          if(isLocked) {
             if(div.querySelector('input')) return;
             div.innerHTML = `<input type="password" class="inline-pass-input" placeholder="PASSWORD..." autocomplete="off">`;
             const input = div.querySelector('input');
             setTimeout(() => input.focus(), 50);
             input.addEventListener('input', (ev) => {
                if(ev.target.value === item.password) { input.style.color = "#00ff88"; input.blur(); setTimeout(() => { window.location.href = item.link; div.innerHTML = originalHTML; }, 300); }
             });
             input.addEventListener('blur', () => { if(input.value === "") setTimeout(() => { div.innerHTML = originalHTML; }, 200); });
          } else { window.location.href = item.link; }
        };
        container.appendChild(div);
      });
    }
  </script>
</body>
</html>
